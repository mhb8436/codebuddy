# 시험 기능 통합 테스트 시나리오

## 테스트 환경 준비

### 사전 조건
- [ ] 서버가 실행 중인지 확인 (`pnpm dev`)
- [ ] PostgreSQL 데이터베이스 연결 확인
- [ ] 관리자 계정 로그인 가능
- [ ] 학생 계정 로그인 가능

### 테스트 계정
| 역할 | 이메일 | 비밀번호 |
|------|--------|----------|
| 관리자 | admin@test.com | (설정된 비밀번호) |
| 학생 | student@test.com | (설정된 비밀번호) |

---

## 시나리오 1: 문제 은행 관리 (관리자)

### TC-1.1: 문제 은행 페이지 접근
**목적**: 관리자가 문제 은행 관리 페이지에 접근할 수 있는지 확인

**테스트 단계**:
1. [ ] 관리자 계정으로 로그인
2. [ ] 관리자 페이지(`/admin`)로 이동
3. [ ] "문제 은행" 탭 클릭

**예상 결과**:
- [ ] 문제 은행 관리 UI가 표시됨
- [ ] 언어 선택 드롭다운이 표시됨 (JavaScript, TypeScript, Python)
- [ ] 트랙 선택 드롭다운이 표시됨

---

### TC-1.2: 토픽 통계 조회
**목적**: 선택한 트랙의 토픽별 문제 통계를 조회할 수 있는지 확인

**테스트 단계**:
1. [ ] 언어 선택: `javascript`
2. [ ] 트랙 선택: (사용 가능한 트랙 선택)
3. [ ] 통계 테이블 확인

**예상 결과**:
- [ ] 토픽별 통계 테이블이 표시됨
- [ ] 각 토픽의 난이도별 문제 수 (easy/medium/hard) 확인 가능
- [ ] 승인된 문제 수 / 대기 중 문제 수 표시

---

### TC-1.3: 문제 생성 요청 (백그라운드)
**목적**: 관리자가 특정 토픽에 대해 문제 생성을 요청할 수 있는지 확인

**테스트 단계**:
1. [ ] 토픽 통계 테이블에서 "문제 생성" 버튼 클릭
2. [ ] 생성 모달에서 난이도별 개수 설정:
   - Easy: 2개
   - Medium: 2개
   - Hard: 1개
3. [ ] "생성 시작" 버튼 클릭

**예상 결과**:
- [ ] "문제 생성 작업이 시작되었습니다" 메시지 표시
- [ ] 생성 작업 테이블에 새 작업이 `pending` 또는 `in_progress` 상태로 추가됨
- [ ] 작업 완료 후 상태가 `completed`로 변경됨

**확인 사항**:
- [ ] 서버 콘솔에 `[QuestionGenerator] Starting job ...` 로그 출력
- [ ] 작업 완료 후 `[QuestionGenerator] Job ... completed` 로그 출력

---

### TC-1.4: 생성된 문제 목록 조회
**목적**: 생성된 문제 목록을 조회하고 필터링할 수 있는지 확인

**테스트 단계**:
1. [ ] 토픽 선택하여 문제 목록 조회
2. [ ] 상태 필터 테스트:
   - [ ] "전체" 선택 시 모든 문제 표시
   - [ ] "대기중" 선택 시 pending 문제만 표시
   - [ ] "승인됨" 선택 시 approved 문제만 표시
3. [ ] 난이도 필터 테스트:
   - [ ] "쉬움" 선택 시 easy 문제만 표시
   - [ ] "보통" 선택 시 medium 문제만 표시
   - [ ] "어려움" 선택 시 hard 문제만 표시

**예상 결과**:
- [ ] 필터에 따라 문제 목록이 정확히 필터링됨
- [ ] 각 문제의 제목, 난이도, 상태가 표시됨

---

### TC-1.5: 문제 상세 보기 및 수정
**목적**: 개별 문제의 상세 내용을 보고 수정할 수 있는지 확인

**테스트 단계**:
1. [ ] 문제 목록에서 특정 문제 클릭
2. [ ] 문제 상세 정보 확인:
   - [ ] 제목
   - [ ] 설명
   - [ ] 요구사항
   - [ ] 테스트 케이스
   - [ ] 샘플 답안
3. [ ] 제목 수정 후 저장

**예상 결과**:
- [ ] 문제 상세 정보가 올바르게 표시됨
- [ ] 수정 후 변경사항이 저장됨
- [ ] 목록에서 수정된 제목 확인 가능

---

### TC-1.6: 문제 승인
**목적**: 대기 중인 문제를 승인할 수 있는지 확인

**테스트 단계**:
1. [ ] 상태가 "pending"인 문제 선택
2. [ ] "승인" 버튼 클릭
3. [ ] 상태 변경 확인

**예상 결과**:
- [ ] 문제 상태가 "approved"로 변경됨
- [ ] 토픽 통계의 "승인됨" 카운트 증가

---

### TC-1.7: 문제 거부
**목적**: 부적절한 문제를 거부할 수 있는지 확인

**테스트 단계**:
1. [ ] 상태가 "pending"인 문제 선택
2. [ ] "거부" 버튼 클릭
3. [ ] 상태 변경 확인

**예상 결과**:
- [ ] 문제 상태가 "rejected"로 변경됨

---

### TC-1.8: 문제 일괄 승인
**목적**: 여러 문제를 한 번에 승인할 수 있는지 확인

**테스트 단계**:
1. [ ] 여러 pending 문제 체크박스 선택
2. [ ] "선택 항목 승인" 버튼 클릭

**예상 결과**:
- [ ] 선택한 모든 문제의 상태가 "approved"로 변경됨
- [ ] 성공 메시지 표시

---

### TC-1.9: 문제 삭제
**목적**: 문제를 삭제할 수 있는지 확인

**테스트 단계**:
1. [ ] 삭제할 문제 선택
2. [ ] "삭제" 버튼 클릭
3. [ ] 확인 다이얼로그에서 "확인" 클릭

**예상 결과**:
- [ ] 문제가 목록에서 제거됨
- [ ] 토픽 통계 갱신됨

---

## 시나리오 2: 시험 출제 - 문제 은행 사용

### TC-2.1: 문제 은행에서 시험 출제 (충분한 문제)
**목적**: 승인된 문제가 충분할 때 문제 은행에서 즉시 출제되는지 확인

**사전 조건**:
- [ ] 특정 토픽에 승인된 문제가 5개 이상 있어야 함

**테스트 단계**:
1. [ ] 학생 계정으로 로그인
2. [ ] 시험 페이지(`/exam`)로 이동
3. [ ] 시험 설정:
   - 언어: javascript
   - 트랙: (승인된 문제가 있는 트랙)
   - 토픽: (승인된 문제가 있는 토픽)
   - 문제 수: 3
4. [ ] "시험 생성" 버튼 클릭
5. [ ] 응답 시간 측정

**예상 결과**:
- [ ] 시험이 **즉시** 생성됨 (1-2초 이내)
- [ ] 서버 로그: `[Exam Master] Successfully fetched X questions from bank`
- [ ] 문제 은행의 승인된 문제 중에서 랜덤 선택됨

---

### TC-2.2: 하이브리드 출제 (부분적 문제 은행)
**목적**: 승인된 문제가 부족할 때 하이브리드 방식으로 출제되는지 확인

**사전 조건**:
- [ ] 특정 토픽에 승인된 문제가 2개만 있어야 함

**테스트 단계**:
1. [ ] 시험 설정:
   - 문제 수: 5 (승인된 문제 2개보다 많음)
2. [ ] "시험 생성" 버튼 클릭

**예상 결과**:
- [ ] 시험 생성됨 (LLM 생성 시간 포함)
- [ ] 서버 로그: `[Exam Master] Partial bank fetch: 2 from bank, 3 from LLM`
- [ ] 2개는 문제 은행에서, 3개는 LLM이 생성

---

### TC-2.3: LLM 전체 생성 (빈 문제 은행)
**목적**: 승인된 문제가 없을 때 LLM으로 전체 생성되는지 확인

**사전 조건**:
- [ ] 해당 토픽에 승인된 문제가 없어야 함

**테스트 단계**:
1. [ ] 승인된 문제가 없는 토픽 선택
2. [ ] "시험 생성" 버튼 클릭

**예상 결과**:
- [ ] 시험 생성됨 (LLM 생성 시간 소요, 10-30초)
- [ ] 서버 로그: `[Exam Master] No questions from bank, generating X via LLM`

---

## 시나리오 3: 시험 응시 및 채점

### TC-3.1: 시험 시작
**목적**: 생성된 시험을 시작할 수 있는지 확인

**테스트 단계**:
1. [ ] 시험 생성 후 "시험 시작" 버튼 클릭
2. [ ] 시험 화면 확인

**예상 결과**:
- [ ] 시험 타이머가 시작됨
- [ ] 첫 번째 문제가 표시됨
- [ ] 문제 네비게이션(1, 2, 3...)이 표시됨

---

### TC-3.2: 답안 제출 및 채점 (정답)
**목적**: 정답을 제출했을 때 올바르게 채점되는지 확인

**테스트 단계**:
1. [ ] 문제의 요구사항에 맞는 정확한 코드 작성
2. [ ] "제출" 버튼 클릭
3. [ ] 채점 결과 확인

**예상 결과**:
- [ ] "정답입니다!" 메시지 표시
- [ ] 테스트 케이스별 통과 여부 표시 (모두 통과)
- [ ] 해당 문제 점수 획득

---

### TC-3.3: 답안 제출 및 채점 (오답)
**목적**: 오답을 제출했을 때 피드백이 제공되는지 확인

**테스트 단계**:
1. [ ] 의도적으로 틀린 코드 작성
2. [ ] "제출" 버튼 클릭
3. [ ] 채점 결과 및 피드백 확인

**예상 결과**:
- [ ] 실패한 테스트 케이스 표시
- [ ] 기대 출력 vs 실제 출력 비교 표시
- [ ] AI 피드백 제공 (왜 틀렸는지 설명)

---

### TC-3.4: 문제 간 이동
**목적**: 시험 중 문제 간 이동이 가능한지 확인

**테스트 단계**:
1. [ ] 문제 2번 클릭
2. [ ] 문제 1번으로 돌아가기
3. [ ] 이전에 작성한 코드가 유지되는지 확인

**예상 결과**:
- [ ] 문제 간 자유로운 이동 가능
- [ ] 작성한 코드가 유지됨
- [ ] 제출한 문제는 "답변됨" 표시

---

### TC-3.5: 시험 종료 및 결과
**목적**: 시험을 종료하고 최종 결과를 확인할 수 있는지 확인

**테스트 단계**:
1. [ ] 모든 문제 답안 제출
2. [ ] "시험 종료" 버튼 클릭
3. [ ] 최종 결과 화면 확인

**예상 결과**:
- [ ] 총점 / 만점 표시
- [ ] 백분율 점수 표시
- [ ] 등급 표시 (A/B/C/D/F)
- [ ] 문제별 점수 요약

---

### TC-3.6: 시간 초과 처리
**목적**: 시험 시간이 초과되었을 때 적절히 처리되는지 확인

**테스트 단계**:
1. [ ] 시험 시간 제한을 1분으로 설정하여 시험 생성
2. [ ] 시험 시작 후 1분 대기
3. [ ] 시간 초과 후 답안 제출 시도

**예상 결과**:
- [ ] 시간 초과 경고 표시
- [ ] 답안 제출 시 "시험 시간이 초과되었습니다" 오류

---

## 시나리오 4: 에러 처리

### TC-4.1: 네트워크 오류 처리
**목적**: 네트워크 오류 시 적절한 에러 메시지가 표시되는지 확인

**테스트 단계**:
1. [ ] 서버를 중지한 상태에서 시험 생성 시도

**예상 결과**:
- [ ] 네트워크 오류 메시지 표시
- [ ] 사용자 친화적인 에러 메시지

---

### TC-4.2: 인증 만료 처리
**목적**: 토큰 만료 시 적절히 처리되는지 확인

**테스트 단계**:
1. [ ] 오래된 토큰으로 API 호출

**예상 결과**:
- [ ] 401 Unauthorized 응답
- [ ] 로그인 페이지로 리다이렉트

---

## 테스트 결과 요약

| 시나리오 | 테스트 케이스 | 결과 | 비고 |
|---------|-------------|------|------|
| 1. 문제 은행 관리 | TC-1.1 ~ TC-1.9 | | |
| 2. 시험 출제 | TC-2.1 ~ TC-2.3 | | |
| 3. 시험 응시 | TC-3.1 ~ TC-3.6 | | |
| 4. 에러 처리 | TC-4.1 ~ TC-4.2 | | |

### 테스트 일자: ____________________
### 테스터: ____________________
### 버전: ____________________

---

## 성능 기준

| 항목 | 기준 | 측정값 |
|------|------|--------|
| 문제 은행 출제 응답 시간 | < 2초 | |
| LLM 전체 생성 응답 시간 | < 30초 | |
| 답안 채점 응답 시간 | < 5초 | |
| 문제 목록 로딩 시간 | < 1초 | |

---

## 알려진 이슈

(테스트 중 발견된 이슈를 여기에 기록)

1.
2.
3.
